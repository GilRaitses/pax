<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pax NYC - Traffic Camera Collection Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.15);
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: 700;
            color: #667eea;
        }
        
        .stat-subtext {
            font-size: 0.85em;
            color: #999;
            margin-top: 5px;
        }
        
        .camera-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .camera-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .camera-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }
        
        .camera-name {
            font-weight: 600;
            font-size: 1.05em;
            color: #333;
            flex: 1;
        }
        
        .camera-badge {
            background: #667eea;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .camera-badge.high { background: #f56565; }
        .camera-badge.medium { background: #ed8936; }
        .camera-badge.low { background: #48bb78; }
        
        .camera-meta {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 8px;
        }
        
        .camera-count {
            font-size: 1.8em;
            font-weight: 700;
            color: #667eea;
            margin: 10px 0;
        }
        
        .camera-last-capture {
            font-size: 0.8em;
            color: #999;
        }
        
        .refresh-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 12px 20px;
            border-radius: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .section-title {
            color: white;
            font-size: 1.5em;
            font-weight: 600;
            margin-bottom: 20px;
            margin-top: 30px;
        }
        
        .error-message {
            background: #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
        
        .storage-info {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 0.9em;
        }
        
        .proposal-section {
            background: white;
            border-radius: 12px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .proposal-section h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .proposal-section h3 {
            color: #764ba2;
            font-size: 1.3em;
            margin-bottom: 12px;
            margin-top: 0;
        }
        
        .proposal-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .proposal-card p {
            margin: 0;
            line-height: 1.6;
        }
        
        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #d63384;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 style="font-size: 2.8em; margin-bottom: 15px;">Energetic Pathfinding and Perceptual Heuristics</h1>
            <div class="subtitle" style="font-size: 1.3em; margin-bottom: 10px;">Manhattan Navigation via Learned A* Search</div>
            <div style="margin-top: 15px; font-size: 0.95em; opacity: 0.9;">
                <div>CIS 667: Introduction to Artificial Intelligence – Term Project</div>
                <div style="margin-top: 8px;">Gil Raitses | Syracuse University | Data Science / HCAI Program</div>
            </div>
        </header>

        <div class="proposal-section">
            <h2>Introduction</h2>
            <p style="font-size: 1.05em; line-height: 1.7; color: #333; margin-bottom: 25px;">
                Traditional pathfinding algorithms optimize for geometric distance or travel time but fail to capture the 
                <strong>energetic and perceptual dynamics</strong> of movement in dense urban environments. In Manhattan, 
                the cost of traversing a route is not defined by distance alone but by <strong>sensory and behavioral complexity</strong>: 
                crowding, visual noise, infrastructure gaps and movement unpredictability.
            </p>

            <p style="font-size: 1.1em; line-height: 1.7; color: #333; font-weight: 600; margin: 25px 0;">
                <strong>Key Research Question:</strong> Can learned heuristics from vision-based environmental features outperform 
                standard Manhattan-distance baselines in predicting route stress and improving path interpretability?
            </p>

            <p style="font-size: 1.05em; line-height: 1.7; color: #333;">
                This work develops a <strong>perceptually informed heuristic</strong> for A* search using NYC traffic camera data. 
                The heuristic models environmental resistance by extracting features from visual data. Human pedestrians naturally 
                avoid stressful routes based on crowded intersections, poor lighting and aggressive traffic patterns; this approach 
                encodes similar avoidance behavior.
            </p>

            <div style="background: #f8f9fa; padding: 25px; border-radius: 12px; margin: 30px 0; border-left: 4px solid #667eea;">
                <h3 style="color: #667eea; margin-top: 0;">Aim</h3>
                <p style="margin: 0; font-size: 1.05em; line-height: 1.6;">
                    Implement and evaluate a heuristic search system that learns energetic pathfinding behavior by integrating 
                    sensory data into classical A* reasoning. Test whether perception-driven cost modeling improves interpretability 
                    and environmental realism in AI navigation.
                </p>
            </div>

            <h2>Study Area</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                <div class="proposal-card">
                    <h3>Navigation Environment</h3>
                    <p>Assemble the Grand Central–Carnegie Hall corridor graph in EPSG:2263 using NYC DCM street centerlines; 
                    snap 161 intersections to the projected grid, overlay official hydrography and park polygons, and link each 
                    node to the nearest DOT camera through Voronoi zone IDs.</p>
                </div>
                <div class="proposal-card">
                    <h3>State Space</h3>
                    <p><strong>States S:</strong> Set of 161 intersection nodes (where streets cross) spanning a corridor bounded 
                    by extending ±2 streets and ±1 avenue from each endpoint: 40th to 59th St, Lexington to 8th Ave<br><br>
                    <strong>Initial State s₀:</strong> Grand Central (42nd & Park)<br>
                    <strong>Goal State s₉:</strong> Carnegie Hall (57th & 7th)</p>
                </div>
                <div class="proposal-card">
                    <h3>Camera Coverage</h3>
                    <p>Manhattan street network with 40 camera coverage zones in the corridor (Voronoi tessellation); dynamic 
                    traffic conditions; partially observable via camera sensors. Each camera provides multi-dimensional feature 
                    vectors encoding violations, density, infrastructure quality.</p>
                </div>
            </div>

            <h2>Methodology</h2>
            <div style="background: rgba(255, 255, 255, 0.95); padding: 25px; border-radius: 12px; margin: 20px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h3 style="color: #667eea; margin-top: 0;">Agent Framework</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div>
                        <strong>Performance Measure:</strong> Minimize energetic cost (stress score) along navigation path
                    </div>
                    <div>
                        <strong>Environment:</strong> Manhattan street network with 40 camera zones, dynamic traffic conditions
                    </div>
                    <div>
                        <strong>Actuators:</strong> Directional movements (N, S, E, W) along street intersections
                    </div>
                    <div>
                        <strong>Sensors:</strong> Computer vision analysis of traffic camera imagery; multi-dimensional feature vectors
                    </div>
                </div>

                <h3 style="color: #667eea; margin-top: 20px;">Heuristic Design</h3>
                <div style="margin-top: 15px;">
                    <p style="margin-bottom: 10px;"><strong>Baseline: Manhattan Distance</strong></p>
                    <p style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                        <code>h<sub>manhattan</sub>(n) = |x<sub>n</sub> - x<sub>goal</sub>| + |y<sub>n</sub> - y<sub>goal</sub>|</code><br>
                        <span style="color: #666; font-size: 0.9em;">Admissible but ignores environmental context.</span>
                    </p>

                    <p style="margin-bottom: 10px;"><strong>Learned Perceptual Heuristic</strong></p>
                    <p style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                        <code>h<sub>learned</sub>(n) = w<sup>T</sup> f(n) + b</code><br>
                        <span style="color: #666; font-size: 0.9em;">
                        where <strong>f(n)</strong> represents the feature vector for node n, <strong>w</strong> denotes the learned 
                        weights from Ridge regression and <strong>b</strong> is the intercept term. Each intersection n inherits 
                        features from its nearest camera via Voronoi tessellation.
                        </span>
                    </p>

                    <p style="margin-bottom: 10px;"><strong>Adaptive Weighted A*</strong></p>
                    <p style="background: #f8f9fa; padding: 15px; border-radius: 6px;">
                        <code>f(n) = g(n) + W · h<sub>learned</sub>(n)</code><br>
                        <span style="color: #666; font-size: 0.9em;">
                        with W ∈ {1.0, 1.2, 1.5} to balance the exploration-exploitation tradeoff: higher weights prioritize 
                        heuristic guidance (faster search) while lower weights preserve optimality guarantees.
                        </span>
                    </p>
                </div>
            </div>

            <h2>Objectives</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin: 20px 0;">
                <div class="proposal-card">
                    <h3>Knowledge Base</h3>
                    <p>Engineer a data pipeline that captures a one-week window of traffic camera imagery, runs computer vision 
                    analysis, normalizes feature vectors and stores symbolic predicates such as <code>high_pedestrian</code> and 
                    <code>bike_violation</code> for search-time reasoning.</p>
                </div>
                <div class="proposal-card">
                    <h3>Perceptual Heuristic</h3>
                    <p>Fit a Ridge regression model on annotated camera data to learn energetic weights, calibrate cost scaling 
                    with stratified cross-validation and expose a reusable function returning h(n) = w<sup>T</sup> f<sub>zone(n)</sub> 
                    with interpretable coefficients.</p>
                </div>
                <div class="proposal-card">
                    <h3>A* Implementation</h3>
                    <p>Implement baseline A*, learned A* and adaptive weighted A* (W ∈ {1.0, 1.2, 1.5}); instrument node expansions, 
                    path costs and admissibility checks for the learned heuristic.</p>
                </div>
                <div class="proposal-card">
                    <h3>Evaluation</h3>
                    <p>Compare systems via Monte Carlo route sampling, Mean Absolute Error on stress predictions, search effort 
                    (nodes expanded, runtime), path diversity and permutation importance to surface dominant perceptual factors.</p>
                </div>
            </div>
        </div>
        
        <div class="error-message" id="errorMessage"></div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Total Images</div>
                <div class="stat-value" id="totalImages">0</div>
                <div class="stat-subtext">Captured frames</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Active Cameras</div>
                <div class="stat-value" id="activeCameras">0</div>
                <div class="stat-subtext">Monitored locations</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Latest Capture</div>
                <div class="stat-value" id="latestCapture" style="font-size: 1.2em;">--</div>
                <div class="stat-subtext">Last collection time</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">Collection Rate</div>
                <div class="stat-value" id="collectionRate">30</div>
                <div class="stat-subtext">Minutes per cycle</div>
            </div>
        </div>
        
        <div class="storage-info">
            <strong>Storage:</strong> <span id="storageInfo">Loading...</span>
        </div>
        
        <h2 class="section-title">Data Collection Status</h2>
        
        <div class="camera-grid" id="cameraGrid">
            <!-- Camera cards will be inserted here -->
        </div>
        
        <div class="refresh-indicator">
            <div class="spinner"></div>
            <span>Auto-refresh every 30s</span>
        </div>
    </div>
    
    <script>
        const API_BASE = window.location.hostname === 'localhost' 
            ? 'http://localhost:8000' 
            : '';
        
        let cameraManifest = [];
        
        async function loadManifest() {
            try {
                const response = await fetch(`${API_BASE}/api/manifest`);
                const manifest = await response.json();
                cameraManifest = manifest.cameras || [];
                
                // Update project info
                if (manifest.project) {
                    document.querySelector('.subtitle').textContent = manifest.project.description || 'Traffic Camera Collection Dashboard';
                }
            } catch (error) {
                console.error('Failed to load manifest:', error);
                showError('Failed to load camera manifest');
            }
        }
        
        async function fetchStats() {
            try {
                const response = await fetch(`${API_BASE}/api/stats`);
                const stats = await response.json();
                updateDashboard(stats);
            } catch (error) {
                console.error('Failed to fetch stats:', error);
                showError('Failed to fetch statistics: ' + error.message);
            }
        }
        
        function updateDashboard(stats) {
            document.getElementById('totalImages').textContent = stats.totalImages.toLocaleString();
            document.getElementById('activeCameras').textContent = stats.activeCameras;
            
            if (stats.latestCapture) {
                const captureDate = new Date(stats.latestCapture);
                document.getElementById('latestCapture').textContent = captureDate.toLocaleTimeString();
            }
            
            document.getElementById('storageInfo').textContent = stats.storageInfo;
            
            // Update camera grid
            const cameraGrid = document.getElementById('cameraGrid');
            cameraGrid.innerHTML = '';
            
            cameraManifest.forEach(camera => {
                const cameraData = stats.cameraCounts[camera.id] || { count: 0, lastCapture: null };
                const card = createCameraCard(camera, cameraData);
                cameraGrid.appendChild(card);
            });
        }
        
        function createCameraCard(camera, data) {
            const card = document.createElement('div');
            card.className = 'camera-card';
            
            const lastCapture = data.lastCapture 
                ? new Date(data.lastCapture).toLocaleString()
                : 'No captures yet';
            
            card.innerHTML = `
                <div class="camera-header">
                    <div class="camera-name">${camera.name}</div>
                    <div class="camera-badge ${camera.priority}">${camera.priority}</div>
                </div>
                <div class="camera-meta">${camera.area}</div>
                <div class="camera-count">${data.count.toLocaleString()}</div>
                <div class="camera-last-capture">Last: ${lastCapture}</div>
            `;
            
            return card;
        }
        
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }
        
        // Initial load
        async function initialize() {
            await loadManifest();
            await fetchStats();
        }
        
        initialize();
        
        // Auto-refresh every 30 seconds
        setInterval(fetchStats, 30000);
    </script>
</body>
</html>

